/*E*/
/* Fichier : $Id: ITMA_TBN_VerifOrtho.am,v 1.1 2007/03/26 14:30:46 gesconf Exp $      Release : $Revision: 1.1 $        Date : $Date: 2007/03/26 14:30:46 $
-------------------------------------------------------------------------------
* STERIA *  PROJET MIGRAZUR
-------------------------------------------------------------------------------
* SOUS-SYSTEME  GESIHM
-------------------------------------------------------------------------------
* MODULE ITMA_TBN * FICHIER ITMA_TBN_Fiche_Bloc_Notes.am
-------------------------------------------------------------------------------
* DESCRIPTION DU MODULE :
* Afficher et recueillir les notes d'un operateur pour passage de poste
*
*   Cf. DCG 2.4.13
*
-------------------------------------------------------------------------------
* HISTORIQUE :
*
* Guilhou    27 Sep 1994 : Creation						V1.1
* Guilhou    13 Oct 1994 : inclusion de xzic_ax.h				V1.3
* Torregrossa 03 Jul 1995  : Modif repertoire de travail  et 
*                            la liste des machines                   V 1.6
* Torregrossa 03 Jul 1995  : Correction bug                          V 1.7
* Torregrossa 25 Jan 1996  : Suppression le par defaut de quitter (car ne fonctionne
*                            pas avec liste)                         V 1.8
* Guilhou 	26 Mar 1996 : Ouverture automatique de la fiche BN de la machine quand
*				appel sur la prise de poste	V1.9 (DEM 749)
* Guilhou	28 Mar 1996 : Ajout montre sur ouverture automatique V1.10
* Guilhou	19 sep 1996 : ajout pc simplifies (RADT)	V1.11
* niepceron	26 mar 1997 : ajout POPAN1 (1359)	V1.12
* Guilhou	13 jan 1998 : ajout PODA1, PODY1, PODP1 (dem/1533) 1.13
* Torregrossa	05 mar 1998 : rechercher les alertes meteo traitees en l'abscence 
*                             de l'operareur sur PC2 ou PC3 (dem/1606) 1.14
* Torregrossa	13 mar 1998 : Correction suite a dem/1606 1.15
---------------------------------------------------------------------------- */

INCLUDE	"dbase_.am"
INCLUDE	"../inc/ITMA_COM.h"
INCLUDE	"../inc/ITMA_TDO.h"
INCLUDE	"../inc/ITMA_TFL.h"
INCLUDE    "../../XDMICG/inc/xzic_ax.h"
INCLUDE    "../../XDMICG/inc/xdc_ax.h"
INCLUDE "../inc/xzat01sp.h"
INCLUDE "../inc/xzaa07sp.h"



DEFINE C_MODULE	"MTBN"		' Nom du module

/*X*/
/* ----------------------------------------------------------------------------
* SERVICE RENDU :
* Verification ortho du texte en arg*
-------------------------------------------------------------------------------
* SEQUENCE D'APPEL :
*/

MACRO ITMA_TBN_VerifOrtho (vl_texte)

/*A
 * Traitements en cas d'erreur durant l'initialisation :
 * informer l'operateur, tracer l'erreur et abandonner
 * -----------------------------------------------------
 */

ON ERROR {
    ERROR_BOX@
    COM01_Trace (COM_WARNING, COM03_Message_Erreur (C_MODULE))
    RETURN
}


	WRITE_ASCII_FILE@("/tmp/bn.txt",vl_texte)
	WP_APPLICATION_DLG@ (200, FALSE)
	WP_VIEW_EXPRESSLINE@()
	WP_SET_RULER_DISPLAY@(FALSE)
	WP_SET_ALL_BOUNDS_DISPLAY@(FALSE)
	WP_VIEW_150@()

	WP_IMPORT_ASCII_LINES@("/tmp/bn.txt",TRUE)
	WP_GOTO_BEGINNING@()
	WP_SELECT_ALL@()
	WP_TEXT_HELVETICA@()
	WP_GOTO_BEGINNING@()
	WP_SPELLINGS_DLG@()
	WP_EXPORT_ASCII_LINES@("/tmp/bn.txt")
	WP_EXIT@()

ENDMACRO


