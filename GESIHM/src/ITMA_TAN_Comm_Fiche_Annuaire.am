/*E*/
/* Fichier : $Id: ITMA_TAN_Comm_Fiche_Annuaire.am,v 1.3 1996/12/24 13:22:30 verdier Exp $      Release : $Revision: 1.3 $        Date : $Date: 1996/12/24 13:22:30 $
-------------------------------------------------------------------------------
* STERIA *  PROJET MIGRAZUR
-------------------------------------------------------------------------------
* SOUS-SYSTEME  GESIHM
-------------------------------------------------------------------------------
* MODULE ITMA_TAN * FICHIER ITMA_TAN_Comm_Fiche_Annuaire.am
-------------------------------------------------------------------------------
* DESCRIPTION DU MODULE :
*
* Fiche annuaire, fiche astreinte.
*
*   Cf. DCG 2.4.27, 2.4.32
*
-------------------------------------------------------------------------------
* HISTORIQUE :
*
* Lecrivain	20 Oct 1994	: Creation
* Guilhou	24 dec 1996	: on modifie en base au CI si on est sur un district (DEM/1367) 1.3
---------------------------------------------------------------------------- */

INCLUDE	"dbase_.am"
INCLUDE "../inc/ITMA_COM.h"
INCLUDE "../inc/ITMA_TFA.h"
INCLUDE "../../XDMICG/inc/xdc_ax.h"

INCLUDE "../inc/xzan21sp.h"



/*X*/
/* ----------------------------------------------------------------------------
* SERVICE RENDU :
*  Modifie les informations de commentaire de la fiche annuaire de numero
*  indique.
-------------------------------------------------------------------------------
* SEQUENCE D'APPEL :
*/

MACRO ITMA_TAN_Comm_Fiche_Annuaire (va_num_fiche, va_commentaire,
				      va_date_validite, va_telephone, va_module)

/*
* ARGUMENTS EN ENTREE :
*   va_num_fiche      : Numero de la fiche a modifier ;
*   va_commentaire    : Nouveau texte de commentaire ;
*   va_date_validite  : Nouvelle date de validite du commentaire;
*   va_telephone      : Nouveau numero de telephone ;
*   va_module         : Nom du module appelant.
*
*
* ARGUMENTS EN SORTIE : Aucun
*
*
* CODE RETOUR         : COM_OK en cas d'execution correcte, COM_NOK sinon.
*
* CONDITION D'UTILISATION
*   ITMA_TFA_Fiche_Annuaire
*   ITMA_TFS_Fiche_Astreinte
*
* FONCTION
*   Met simplement a jour la base de donnees a l'aide de la requete adequate.
*
---------------------------------------------------------------------------- */

    VAR FORMAT SQL_Procedure_Params@ vl_parametres
    VAR FORMAT SQL_Procedure_Result@ vl_resultats


vl_parametres[0].type = TFA_Numero_Fiche_Annuaire
vl_parametres[0].data = va_num_fiche
vl_parametres[0].output = FALSE

vl_parametres[1].type = SYB#CHAR_
vl_parametres[1].data = va_commentaire
vl_parametres[1].output = FALSE

vl_parametres[2].type = SYB#DATETIME_
vl_parametres[2].data = va_date_validite
vl_parametres[2].output = FALSE

vl_parametres[3].type = SYB#CHAR_
vl_parametres[3].data = va_telephone
vl_parametres[3].output = FALSE

IF COM41_SQL_Procedure_Distante (XDC_CI,XZAN21_Comment_Fiche_Annuaire,
			   vl_parametres, vl_resultats, va_module) <> COM_OK
    RETURN (COM_NOK)

RETURN (COM_OK)

ENDMACRO
