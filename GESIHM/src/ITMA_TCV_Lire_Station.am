/*E*/
/* Fichier : $Id: ITMA_TCV_Lire_Station.am,v 1.1 1995/06/08 17:09:40 gaborit Exp $      Release : $Revision: 1.1 $        Date : $Date: 1995/06/08 17:09:40 $
-------------------------------------------------------------------------------
* STERIA *  PROJET MIGRAZUR
-------------------------------------------------------------------------------
* SOUS-SYSTEME  GESIHM
-------------------------------------------------------------------------------
* MODULE ITMA_COM * FICHIER ITMA_COM_Lire_Stations.am
-------------------------------------------------------------------------------
* DESCRIPTION DU MODULE :
*
*   Fonctions communes.
*
*   Non decrit dans le DCG
*
-------------------------------------------------------------------------------
* HISTORIQUE :
*
* Torregrossa 07 Juin 1995	: Creation           V1.1
---------------------------------------------------------------------------- */

INCLUDE	"dbase_.am"
INCLUDE "../inc/ITMA_COM.h"
INCLUDE "../inc/ITMA_TCV.h"

INCLUDE "../inc/xzao310sp.h"



/*X*/
/* ----------------------------------------------------------------------------
* SERVICE RENDU :
*  Lit les informations sur des stations.
-------------------------------------------------------------------------------
* SEQUENCE D'APPEL :
*/

MACRO ITMA_TCV_Lire_Station (va_station, 
				FORMAT TCV_Donnees_Station va_info_station,
				va_module)

/*
* ARGUMENTS EN ENTREE :
*   va_station        : Identifiant de la station
*   va_module         : Nom du module appelant.
*
*
* ARGUMENTS EN SORTIE :
*   va_info_station   : Informations sur la station lues en base.
*
*
* CODE RETOUR         : COM_OK en cas d'execution correcte, COM_NOK sinon.
*
* CONDITION D'UTILISATION
*   Toute macro.
*
* FONCTION
*   Lit en base de donnees et retourne les informations sur la station
*
---------------------------------------------------------------------------- */

    VAR FORMAT SQL_Procedure_Params@ vl_parametres
    VAR FORMAT SQL_Procedure_Result@ vl_resultats


/*A
 * Lire en base de donnees les equipements verifiant les criteres
 * --------------------------------------------------------------
 */

vl_parametres[0].type = COM_Identifiant_Equipement
vl_parametres[0].data = va_station
vl_parametres[0].output = FALSE


IF COM05_SQL_Procedure (XZAO310_Lire_PointDeMesure,
			   vl_parametres, vl_resultats, va_module) <> COM_OK
    RETURN (COM_NOK)

va_info_station = vl_resultats.select_results[0]

RETURN (COM_OK)

ENDMACRO
